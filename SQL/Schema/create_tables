-- Customers table
CREATE TABLE customers (
    customer_id INT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    dob DATE NOT NULL,
    kyc_status VARCHAR(20) CHECK (kyc_status IN ('Valid', 'Expired', 'Pending')),
    risk_rating VARCHAR(10) CHECK (risk_rating IN ('Low', 'Medium', 'High'))
);

-- Branches table
CREATE TABLE branches (
    branch_id INT PRIMARY KEY,
    location VARCHAR(100) NOT NULL,
    manager_name VARCHAR(100)
);

-- Accounts table
CREATE TABLE accounts (
    account_id INT PRIMARY KEY,
    customer_id INT NOT NULL,
    branch_id INT NOT NULL,
    account_type VARCHAR(20) CHECK (account_type IN ('Savings', 'Current', 'Credit')),
    balance DECIMAL(15,2) DEFAULT 0,
    FOREIGN KEY (customer_id) REFERENCES customers(customer_id),
    FOREIGN KEY (branch_id) REFERENCES branches(branch_id)
);

-- Transactions table
CREATE TABLE transactions (
    txn_id INT PRIMARY KEY,
    account_id INT NOT NULL,
    txn_date DATE NOT NULL,
    txn_type VARCHAR(20) CHECK (txn_type IN ('Deposit', 'Withdrawal', 'Transfer', 'Payment')),
    amount DECIMAL(15,2) NOT NULL,
    channel VARCHAR(20) CHECK (channel IN ('Online', 'Branch', 'ATM', 'Mobile')),
    FOREIGN KEY (account_id) REFERENCES accounts(account_id)
);
